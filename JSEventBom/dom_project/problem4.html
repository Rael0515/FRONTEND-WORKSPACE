<!DOCTYPE html>
<html>
  <head>
    <title>problem4</title>
    <link type="text/css" rel="stylesheet" href="home.css" />
  </head>
  <body>
    <h4 id="hint">
      fetch 함수를 사용하여 서버
      URL(http://210.93.60.16:8080/frontend/RestController?cmd=list)로 부터
      <br />
      JSON 형식의 student 데이터를 받아 DOM 노드의 생성과 추가를 통해 동적
      테이블을 작성합니다. <br />
      반복문을 통해 각 row 요소에 포함되는 td 요소들을 생성하고(createElement),
      row 요소의 자식으로 추가(appendChild)합니다. <br />
      그리고 table 요소에 row 요소를 자식 요소로 추가합니다. 최종적으로 table
      요소를 id가 target인 요소에 자식 요소로 추가합니다.
    </h4>
    <button class="hint" onClick="sendRequest()">Student 테이블 생성</button>
    <div id="target"></div>
    <script>
      function sendRequest() {
        fetch("http://210.93.60.16:8080/frontend/RestController?cmd=list")
          .then((response) => {
            return response.json();
          })
          .then((data) => {
            let div = document.getElementById("target");
            let table = document.createElement("table");
            let tbody = document.createElement("tbody");

            data.forEach((stu) => {
              let row = document.createElement("tr");
              let values = [
                stu.id,
                stu.passwd,
                stu.depart,
                stu.snum,
                stu.username,
                stu.mobile,
                stu.email,
              ];
              values.forEach((v) => {
                let td = document.createElement("td");
                td.innerText = v ?? "";
                row.appendChild(td);
              });
              tbody.appendChild(row);
            });

            table.appendChild(tbody);
            div.appendChild(table);
          })
          .catch((error) => {
            alert("데이터 불러오기를 실패했습니다.");
            console.log(error);
          });
      }
    </script>
  </body>
</html>
